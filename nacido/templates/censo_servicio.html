{% extends 'base.html' %}
{% block content %}
<div>
  <div class="container pt-3">
    <div>
      <h3>Censos Creados</h3>
    </div>
    <table id="censo_table" class="table table-bordered">
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Servicio</th>
        <th>Estacion</th>
        <th>Camas</th>
        <th># Pendientes</th>
        <th># Atendidos</th>
        <th>Subido al sistema</th>
        <th></th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for x in list %}
      <tr>
        <td> 10/02/2021</td>
        <td>{{ x.nombre }}</td>
        <td>{{ x.estacion }}</td>
        <td>{{ x.ncamas }}</td>
        <td>{{ x.get_n_ingresos }}</td>
        <td>{{ x.get_n_salidas }}</td>
        <td>
          <form action="/integracion/censo/servicio/synced" method="POST">
            {% csrf_token %}
            <input type="hidden" name="servicio_id" value="{{ x.id }}">
            <input name="synced" {% if x.synced %}checked{% endif %} 
              onchange="this.form.submit()" type="checkbox">
          </form>
        </td>
        <td><a href="/integracion/censo/?servicio_id={{ x.id }}" 
          class="btn btn-info">Ingresos</a></td>
        <td><a href="/integracion/censo/salidas/?servicio_id={{ x.id }}" 
          class="btn btn-primary">Egresos</a></td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <hr>
    <h2>Creacion de Censo - Grupo</h2>
    <div class="row">
      <div class="col">
        <fieldset class="border p-2 mb-4">
          <legend  class="w-auto">Registro de Grupo</legend>
          <div class="pl-4">
            <form method="POST" action="/integracion/censo/servicio/">
              {% csrf_token %}
              <div class="pb-4">
                <select name="nombre" id="servicio_combo" class="select-css">
                  <option value="-" selected="selected">-- Seleccione el Servicio -- </option>
                  {% for x in services %}
                  <option value="{{x}}">{{ x }}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="pb-4">
                <label>Seleccione la estacion</label>
                <select name="estacion" id="estacion_combo" class="select-css">
                </select>
              </div>
              <div class="pb-4">
                <label>Seleccione la habitacion</label>
                <select name="habitacion" id="habitacion_combo" class="select-css">
                </select>
              </div>
              <div class="row">
                <div class="col-4">
                  <div class="form-group">
                    <label>Cantidad de camas</label>
                    <input id="inpt_ncama" name="ncamas" type="number" 
                      class="form-control"/>
                  </div>
                  <div class="form-group">
                    <button type="submit" class="btn btn-primary">Crear</button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </fieldset>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block js %}
<script >
  var _data = {{ filtered|safe }};
  var _alldata = {{ alldata|safe }};
</script>
<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css">
<script type="text/javascript" src="//cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.12.0/underscore-min.js"></script>
<script type="text/javascript" src="/static/censo_servicio.js?v=s210922"></script>
{% endblock %}